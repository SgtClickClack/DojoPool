<!DOCTYPE html>
<html>

<head>
    <title>Mobile Device Tests</title>
    <script src="https://unpkg.com/mocha/mocha.js"></script>
    <script src="https://unpkg.com/chai/chai.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/mocha/mocha.css" />
</head>

<body>
    <div id="mocha"></div>

    <script>
        mocha.setup('bdd');
        window.expect = chai.expect;
    </script>

    <!-- Import test files -->
    <script type="module"
        src="{{ url_for('static', filename='js/managers/__tests__/mobile-device-tests.js') }}"></script>

    <script type="module">
        // Wait for all tests to load
        window.addEventListener('load', () => {
            // Run the tests
            const runner = mocha.run();

            // Collect results
            const testResults = {
                passes: 0,
                failures: 0,
                duration: 0,
                details: []
            };

            runner.on('pass', (test) => {
                testResults.passes++;
                testResults.details.push({
                    title: test.fullTitle(),
                    duration: test.duration,
                    state: 'passed'
                });
            });

            runner.on('fail', (test, err) => {
                testResults.failures++;
                testResults.details.push({
                    title: test.fullTitle(),
                    duration: test.duration,
                    state: 'failed',
                    error: err.message
                });
            });

            runner.on('end', () => {
                testResults.duration = runner.stats.duration;
                // Make results available to Selenium
                window.testResults = testResults;

                // Log results to console for debugging
                console.log('Test Results:', testResults);
            });
        });
    </script>
</body>

</html>