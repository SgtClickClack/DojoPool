{% extends "base.html" %}

{% block title %}Venues{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-900">Pool Venues</h1>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('venue.create_venue') }}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            Add New Venue
        </a>
        {% endif %}
    </div>

    <!-- Search and Filter Section -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <form method="GET" class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="space-y-2">
                <label for="city" class="block text-sm font-medium text-gray-700">City</label>
                <input type="text" name="city" id="city" value="{{ request.args.get('city', '') }}"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            </div>
            <div class="space-y-2">
                <label for="features" class="block text-sm font-medium text-gray-700">Features</label>
                <select name="features" id="features" multiple
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    <option value="parking" {% if 'parking' in request.args.getlist('features') %}selected{% endif %}>Parking</option>
                    <option value="food_service" {% if 'food_service' in request.args.getlist('features') %}selected{% endif %}>Food Service</option>
                    <option value="bar" {% if 'bar' in request.args.getlist('features') %}selected{% endif %}>Bar</option>
                    <option value="tournaments" {% if 'tournaments' in request.args.getlist('features') %}selected{% endif %}>Tournaments</option>
                    <option value="lessons" {% if 'lessons' in request.args.getlist('features') %}selected{% endif %}>Lessons</option>
                </select>
            </div>
            <div class="space-y-2">
                <label for="min_tables" class="block text-sm font-medium text-gray-700">Minimum Tables</label>
                <input type="number" name="min_tables" id="min_tables" value="{{ request.args.get('min_tables', '') }}" min="1"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            </div>
            <div class="md:col-span-3 flex justify-end">
                <button type="submit"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Apply Filters
                </button>
            </div>
        </form>
    </div>

    <!-- Venues Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for venue in venues %}
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="relative pb-48">
                <img src="{{ venue.image_url or url_for('static', filename='images/default_venue.jpg') }}"
                    alt="{{ venue.name }}"
                    class="absolute h-full w-full object-cover">
            </div>
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h2 class="text-xl font-bold text-gray-900">{{ venue.name }}</h2>
                    <div class="flex items-center">
                        <span class="text-yellow-400">â˜…</span>
                        <span class="ml-1 text-gray-600">{{ "%.1f"|format(venue.rating or 0) }}</span>
                    </div>
                </div>
                <p class="text-gray-600 mb-4">{{ venue.address }}, {{ venue.city }}</p>
                <div class="flex flex-wrap gap-2 mb-4">
                    {% for feature in venue.features %}
                    <span class="px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded">{{ feature }}</span>
                    {% endfor %}
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">{{ venue.tables }} tables</span>
                    <a href="{{ url_for('venue.get_venue', venue_id=venue.id) }}"
                        class="text-blue-600 hover:text-blue-800 font-medium">View Details</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-span-full text-center py-12">
            <p class="text-gray-600">No venues found matching your criteria.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
