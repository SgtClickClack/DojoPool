import unittest
from recon import ReconnaissanceTool

class TestReconnaissanceTool(unittest.TestCase):
    def setUp(self):
        self.target_url = "https://example.com"
        self.recon = ReconnaissanceTool(self.target_url)

    def test_get_ip_address(self):
        ip = self.recon.get_ip_address()
        self.assertIsNotNone(ip)
        self.assertIsInstance(ip, str)

    def test_scan_ports(self):
        ports = self.recon.scan_ports()
        self.assertIsNotNone(ports)
        self.assertIsInstance(ports, list)

    def test_check_dns_records(self):
        dns_records = self.recon.check_dns_records()
        self.assertIsNotNone(dns_records)
        self.assertIsInstance(dns_records, dict)

    def test_verify_security_headers(self):
        headers = self.recon.verify_security_headers()
        self.assertIsNotNone(headers)
        self.assertIsInstance(headers, dict)

    def test_detect_technologies(self):
        tech = self.recon.detect_technologies()
        self.assertIsNotNone(tech)
        self.assertIsInstance(tech, list)

    def test_run_reconnaissance(self):
        results = self.recon.run_reconnaissance()
        self.assertIsNotNone(results)
        self.assertIsInstance(results, dict)
        self.assertIn('ip_address', results)
        self.assertIn('open_ports', results)
        self.assertIn('dns_records', results)
        self.assertIn('security_headers', results)
        self.assertIn('technologies', results)

if __name__ == '__main__':
    unittest.main() 